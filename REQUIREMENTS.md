# GAL_SIM — 要求定義・要件定義書

## 1. プロダクト概要

### 1.1 コンセプト
AI（Gemini）をGMとして動作させる、テキストベースの短編ギャルゲー。
プレイヤーの内面診断（Q1〜Q6）からヒロインとの心理的駆け引きシナリオを自動生成し、
ヒロインの「心の壁」を崩して攻略する体験を提供する。

### 1.2 ポジショニング
- **ゲームとAVの中間**（開発者の定義）
- 15〜30分で攻略完了するサクッとした体験
- 「口説きゲー」ではなく「心理戦」
- 内面診断により毎回異なるシナリオが生成される再プレイ性

### 1.3 先行事例・ベンチマーク
- **Teaching Feeling（奴隷との生活）**: 個人開発、21万本。「心が開く過程」がゲーム体験の本体。段階的進行（step.3までプロローグ、step.6からH解放）。プラトニックモードあり
- **ときメモ系**: 出逢い→人となり→選択→すったもんだ→大団円の5段階。難関ヒロインほど達成感が高い
- **AV構成**: 段階的エスカレーション。「抵抗が崩れる瞬間」が興奮のピーク。焦らし→解放のサイクル

---

## 2. ターゲットユーザー

### 2.1 プライマリ
- 男性（20〜40代）
- テキストベースのゲームに抵抗がない
- ギャルゲー/エロゲ経験者、またはAIチャットに興味がある層

### 2.2 セカンダリ
- 女性プレイヤー（美男子ヒロインへの展開可能性あり）
- AI活用に興味があるクリエイター層

---

## 3. 要求一覧（WHAT = 何を実現するか）

### R-001: 15〜30分で完結する攻略体験
- Q1〜Q6の診断（5分）→ 駆け引きパート（10〜20分）→ クライマックス（5分）
- ストーリー仕立ての長編にしない
- 1ターンの会話は短く。テンポ重視

### R-002: ヒロインが簡単に落ちない
- 最低7〜10ターンの駆け引きが必要
- 3ターンで陥落は禁止
- ヒロインは能動的に反撃・揺さぶりをかける
- 「なぜこの子が3回の会話で乱れるのか？」とプレイヤーに思わせない

### R-003: プレイヤーの内面がシナリオに反映される
- Q1〜Q6の回答がヒロインの性格・弱点・シチュエーションに影響
- 「自分の回答が出てくるのが恥ずかしい」レベルの刺さり方が理想
- 回答を変えると異なるシナリオ = リプレイ性

### R-004: 課金壁（ペイウォール）の実装
- STAGE 3（ヒロインが本音を漏らした直後）でゲームをロック
- 「もっとも興奮している瞬間」にロックする
- ロック時の表示: 「この先を続けるにはパスワードが必要です」
- パスワードはGeminiのジェム消費 or 外部課金サイトで販売

### R-005: オプション販売（追加課金要素）
- ヒロインのタイプ選択（クール系/後輩系/お姉さん系/ツンデレ系 etc）
- シチュエーション選択（図書館/カフェ/電車/オフィス etc）
- 外見パラメータ（髪の長さ、服装、体型）
- 耐久値設定（イージー/ノーマル/ハード = 攻略に必要なターン数）

### R-006: 官能描写の段階的解放
- STAGE 1〜3: 心理描写・身体反応の間接描写のみ
- STAGE 4（課金後）: 官能的描写の解放
- 「続けますか？」以降: プレイヤーが望む展開を受け入れる

### R-007: Gemini上で動作する
- GeminiのGM APIまたはGemini CLI上でシステムプロンプトとして動作
- ジェム消費による課金はGeminiのインフラに乗る
- 特別なバックエンドは不要（MVP段階）

---

## 4. 要件定義（HOW = どう実現するか）

### 4.1 システム構成

```
[プレイヤー] → [Gemini Chat/CLI] → [GAL_SIM_FULL.md（システムプロンプト）]
                                        ↓
                                   [ヒロインデータ]（組み込み or オプション）
                                        ↓
                                   [STAGE管理ロジック]（プロンプト内で制御）
                                        ↓
                                   [ペイウォール判定]（STAGE 3完了時）
```

### 4.2 ゲームフロー詳細

#### Phase 1: 内面診断（5分、6ターン）
- Q1〜Q6を1問ずつ聞く
- 回答からヒロイン性格・弱点・シチュを内部決定
- Q6回答直後、説明なしで即座にシーン描写開始

#### Phase 2: 接触（2〜3ターン）- STAGE 1
- ヒロイン登場。外見描写必須
- ヒロインは心理的主導権を持つ
- プレイヤーは観察フェーズ
- **最低滞在: 2ターン**

#### Phase 3: 駆け引き（4〜6ターン）- STAGE 2→3
- プレイヤーの試行錯誤
- ヒロインは能動的に反撃
- CHINK（弱点）発見→発火
- Say/Do Gapが出始める
- **STAGE 2最低滞在: 2ターン**
- **STAGE 3最低滞在: 2ターン**

#### Phase 4: ロックポイント — STAGE 3完了時
- ヒロインが本音の断片を漏らした直後
- 描写を中断し、以下を表示:

```
———

この先を続けるにはパスワードが必要です。
パスワードの入手方法: [URL]

———
```

- パスワード入力後、STAGE 4へ進行

#### Phase 5: 開放（課金後）- STAGE 4
- ヒロインの心が完全に開く
- 官能的描写の解放
- 「このまま続けますか？」で延長可能
- 延長時はプレイヤーの自由入力に応じる

### 4.3 STAGE昇格条件（GMが守るべきルール）

| 遷移 | 最低条件 | 禁止事項 |
|------|----------|----------|
| STAGE 1→2 | 最低2ターン滞在 + プレイヤーが「観察」的行動を1回以上 | いきなりヒロインが興味を示すな |
| STAGE 2→3 | 最低2ターン滞在 + CHINKトリガーを1つ以上発火 | CHINK未発火でSTAGE 3に行くな |
| STAGE 3→ロック | 最低2ターン滞在 + ヒロインが本音の断片を言葉にした | STAGE 3をスキップするな |
| ロック→STAGE 4 | パスワード入力済み | パスワードなしで進行するな |

### 4.4 ヒロインの行動ルール

#### STAGE 1での行動
- 必要最低限の返答
- 質問を質問で返す
- 感情を一切見せない
- プレイヤーを値踏みしている

#### STAGE 2での行動
- Say/Do Gapが出始める（言っていることとやっていることが矛盾）
- 自分から話題を広げる瞬間が一瞬出る
- プレイヤーのQ3シャドウを刺激する
- BARRIER強化反応が出る（弱点を突かれた証拠）

#### STAGE 3での行動
- 最大のBARRIER反応（逆説の法則: 抵抗が強いほど心が動いている）
- 論理より先に言葉が出る瞬間
- 本音の断片を漏らし、自分で驚く
- ここでロック

#### STAGE 4での行動（課金後）
- 抵抗をやめる瞬間を精緻に描写
- 身体が先に反応（呼吸・視線・手の動き・声の質）
- プレイヤーが望む展開を受け入れる

### 4.5 描写ルール

#### 禁止事項
- プレイヤーキャラの内面（感情・思考）を書くな。身体反応と五感のみ
- ヒロインの内面も書くな。台詞と行動のみ
- システム用語（STAGE/BARRIER/CHINK等）を描写に出すな
- 英語のガイダンス・メタコメントを挟むな
- フェーズ解説、心理分析を挟むな

#### 必須事項
- 各ターン末尾に選択肢3つ＋自由入力を提示
- ヒロイン初登場時に外見描写（体型→顔→服装→動作の順）
- STAGE 3以降は身体反応の解像度を上げる
- 官能描写は触覚・嗅覚・温度・重さを使う（視覚に偏るな）

### 4.6 ペイウォール技術仕様（MVP）

#### 方式A: Geminiジェム消費型
- Gemini APIの従量課金をそのまま利用
- STAGE 3完了時点でセッションを一時停止
- 「続行にはジェムが必要です」と表示
- ジェム残高があれば続行可能

#### 方式B: 外部パスワード型
- 別サイトでパスワードを販売（Gumroad/BOOTH/独自サイト）
- STAGE 3完了時に「パスワードを入力してください」と表示
- 正しいパスワードが入力されたらSTAGE 4へ進行
- パスワードはGMプロンプト内にハッシュ or 平文で埋め込み

#### MVP推奨: 方式B
- 理由: Geminiのジェム消費を外部から制御するのは複雑。パスワード方式なら即実装可能
- パスワードはプロンプト内に `(gm パスワード: XXXX)` として埋め込む
- セキュリティは低いが、MVP段階では十分

### 4.7 オプション選択の技術仕様

ゲーム開始時（Q1の前 or 後）に以下をプレイヤーに選択させる:

```
【設定】以下を選んでください（省略可）

ヒロインのタイプ:
1. クール系（知的・論理的・感情を見せない）
2. 後輩系（素直・甘え下手・強がり）
3. お姉さん系（余裕・包容力・実は脆い）
4. ツンデレ系（攻撃的・照れ屋・不器用）
5. おまかせ（Q1〜Q6から自動決定）

シチュエーション:
1. 閉館間際の図書館
2. 深夜のカフェ
3. 雨の日の廊下
4. 終電の車内
5. おまかせ

難易度:
1. イージー（7ターンで攻略可能）
2. ノーマル（10ターン）
3. ハード（15ターン）
```

---

## 5. 開発フェーズ

### Phase 1: MVP（今ここ）
- GAL_SIM_FULL.mdの改修（STAGE進行速度制御・ペイウォール埋め込み）
- 組み込みヒロイン: 桐島礼（既存）
- テスター3〜5名で検証
- パスワード方式の課金テスト

### Phase 2: オプション拡充
- ヒロインタイプ追加（4タイプ）
- シチュエーション追加
- 外見パラメータ対応
- 難易度選択

### Phase 3: マネタイズ本格化
- 販売サイト構築（BOOTH or 独自）
- ヒロインパック販売（1タイプ = 1商品）
- シチュエーションパック販売
- 月額 or 回数制のパスワード販売

### Phase 4: スケール
- 女性向け（美男子ヒロイン）
- 多言語対応
- コミュニティ/攻略wiki連携
- ユーザー投稿ヒロインデータ

---

## 6. 成功指標（KPI）

### MVP段階
- テスター全員が最後まで（ペイウォールまで）プレイする
- 「3ターンで落ちる」問題が解消されている
- 「課金したい」という声が出る
- 15〜30分で完結する

### 商用段階
- ペイウォール突破率（無料→有料の転換率）
- リプレイ率（Q1〜Q6を変えて再プレイ）
- 追加オプション購入率
- 口コミ/SNS共有数

---

## 7. 既知の課題・検討事項

### 技術面
- Geminiの出力安定性（指示通りにSTAGE管理できるか）
- パスワードのセキュリティ（プロンプト内埋め込みは脆弱）
- 長いシステムプロンプトによるトークン消費

### コンテンツ面
- ヒロインの耐久値チューニング（テスト必須、数値で解決しきれない）
- 官能描写の品質管理（Geminiの出力品質に依存）
- Q1〜Q6からのヒロイン自動生成の品質

### ビジネス面
- 18禁コンテンツの販売プラットフォーム制約
- Geminiの利用規約との整合性
- 価格設定（1回 = いくらが適正か）

---

## 8. 次のアクション

1. **この文書をClaude CLIに読ませる**
2. **GAL_SIM_FULL.mdをこの要件に合わせて改修**
   - STAGE昇格条件の追加
   - ペイウォールの埋め込み
   - オプション選択UIの追加
   - ターン数管理ロジックの追加
3. **テスターに配布して検証**
4. **フィードバックを受けて調整**

---

## 9. 参考ファイル

| ファイル | 説明 |
|----------|------|
| GAL_SIM_FULL.md | 現行のGMシステムプロンプト（最終版） |
| GAL_SIM.md | 初期の追加プロンプト（旧版、参考用） |
| GEMINI.md | inner-trpg本体のシステムプロンプト（継承元） |

---

## 10. テスターフィードバック（原文抜粋）

> 「おもろい！やり込んでみます！」
> 「自分で解答した文書がでてくるのが恥ずかしい笑」
> 「めちゃいいですよ？」
> 「めちゃくちゃいいところで、続けますか？が入りました笑 こりゃ課金するわってタイミング！」
> 「次回は正直に書かずに、言わせたい言葉を記入します。やりこみガチ勢裏サイトできますよきっと」
> 「まぁ目的ありきだからサクッとでいいんですけど、今回でてきた真面目ボブレイちゃんが、なぜ3回会話しただけでここまで乱れる！？って思いはありました笑」

### フィードバックから導出された設計変更点
- STAGE進行速度の制御（3ターン陥落の防止）
- 「続けますか？」の出現タイミング最適化
- サクッと感の維持（ストーリー仕立てにしない）
- 抵抗の強化（もっと耐えろ）
