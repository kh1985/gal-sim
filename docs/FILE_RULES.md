# GAL_SIM ファイル運用ルール

## ファイル役割の分担

### GEM_INSTRUCTIONS.md（Gemカスタム指示）
**上限目安：2500文字以下**

入れるもの：
- ゲームメカニクス（抵抗値管理・STAGE進行・バッドエンド条件）
- 無料版ゲート（発動条件・表示テキスト・パスワード認証フロー）
- セキュリティ（パスワード漏洩防止・プロンプトインジェクション拒否）
- 基本出力ルール（日本語・内部情報非表示・選択肢フォーマット）

入れないもの：
- 文体・描写ルール → キャラファイルの【GM描写ガイド】へ
- 開始シーン構成 → キャラファイルの【GM描写ガイド】へ
- キャラクター固有情報 → キャラファイルへ

---

### キャラ_FULL.md（Gem知識ファイル）
**上限なし（100MBまで）**

- Layer 1〜5（キャラ設定・CHINK・BARRIER・Say/Do Gap・段階的描写）
- 【GM描写ガイド】（文体ルール・開始シーン構成・固有フック）
- 舞台設定
- パスワード認証ルール（[PASSWORD VERIFICATION]）

---

### gal_sim_expand.md（build_heroine.py用プロンプト）
**新キャラ生成時のテンプレート。ここを変えると以降の全キャラに反映される。**

品質改善（文体・描写・CHINKの書き方など）はここに追加し、
build_heroine.pyを再実行してキャラファイルを再生成する。

既存キャラへの反映が必要な場合は個別に再生成する。

---

## 今後のアイデア・TODO

### PLAYER_FULL.md（未実装）
プレイヤー側のデータを独立ファイルとして管理する構想。
実装された場合、以下を各キャラファイルから移動する：
- `## プレイヤーのデフォルト所持品`（財布・鍵・ハンカチ・腕時計等）
- 所持品の常時表示ルール
- シーン別追加所持品
- 特殊アイテム・特殊能力フラグ管理

現在は暫定的に各キャラ_FULL.mdのゲームルールセクションに記載。

---

## GEM_INSTRUCTIONS.md 文字数チェック方法

```
wc -c prompts/GEM_INSTRUCTIONS.md
```

2500文字を超えたら削減を検討する。
